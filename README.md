# åŸºäº U-Net çš„åŒ»å­¦å›¾åƒåˆ†å‰²ï¼ˆè‚¿ç˜¤åˆ†å‰²ä»»åŠ¡ï¼‰

æœ¬é¡¹ç›®æ˜¯ä¸€ä¸ª **åŸºäº U-Net çš„åŒ»å­¦å›¾åƒè¯­ä¹‰åˆ†å‰²ç¤ºä¾‹å·¥ç¨‹**ï¼Œä»¥è„‘è‚¿ç˜¤åˆ†å‰²ä¸ºç ”ç©¶å¯¹è±¡ï¼Œ
ç›®æ ‡æ˜¯å¸®åŠ©åˆå­¦è€…å¿«é€Ÿç†è§£å¹¶è·‘é€šä¸€ä¸ªå®Œæ•´çš„ **åŒ»å­¦å›¾åƒåˆ†å‰²æµç¨‹**ï¼ŒåŒ…æ‹¬æ•°æ®åŠ è½½ã€æ¨¡å‹è®­ç»ƒä¸ç»“æœæ¨ç†ã€‚

è¯¥é¡¹ç›®é€‚åˆä½œä¸ºï¼š
- æ·±åº¦å­¦ä¹  / è®¡ç®—æœºè§†è§‰ **å…¥é—¨å®è·µ**
- åŒ»å­¦å›¾åƒåˆ†å‰² **æ•™å­¦ç¤ºä¾‹**
- æœ¬ç§‘ç”Ÿæˆ–ç ”0çš„ **ç¬¬ä¸€ä¸ªåˆ†å‰²é¡¹ç›®**

---

## ğŸ“Œ é¡¹ç›®ç®€ä»‹

- **ä»»åŠ¡ç±»å‹**ï¼šåŒ»å­¦å›¾åƒè¯­ä¹‰åˆ†å‰²ï¼ˆSemantic Segmentationï¼‰
- **åˆ†å‰²ç›®æ ‡**ï¼šè„‘è‚¿ç˜¤åŒºåŸŸï¼ˆTumor / Non-Tumorï¼‰
- **æ¨¡å‹ç»“æ„**ï¼šU-Net
- **è¾“å…¥**ï¼šåŒ»å­¦å½±åƒï¼ˆ2D å›¾åƒï¼‰
- **è¾“å‡º**ï¼šåƒç´ çº§åˆ†å‰²ç»“æœï¼ˆmaskï¼‰

---

## ğŸ“‚ æ•°æ®é›†è¯´æ˜

æœ¬é¡¹ç›®ä½¿ç”¨ Kaggle ä¸Šå…¬å¼€çš„è„‘è‚¿ç˜¤è¯­ä¹‰åˆ†å‰²æ•°æ®é›†ï¼š

**Brain Tumor Image Dataset: Semantic Segmentation**

ğŸ”— æ•°æ®é›†åœ°å€ï¼š  
https://www.kaggle.com/datasets/pkdarabi/brain-tumor-image-dataset-semantic-segmentation

### æ•°æ®é›†ç‰¹ç‚¹
- å·²åˆ’åˆ†ä¸º `train / val / test`
- æ¯å¼ å›¾åƒå¯¹åº”ä¸€å¼ åˆ†å‰² mask
- mask ä¸ºäºŒå€¼å›¾åƒï¼š
  - **ç™½è‰²åŒºåŸŸ**ï¼šè‚¿ç˜¤
  - **é»‘è‰²åŒºåŸŸ**ï¼šèƒŒæ™¯

---

## ğŸ§  æ¨¡å‹ç»“æ„

æœ¬é¡¹ç›®é‡‡ç”¨ç»å…¸çš„ **U-Net** ç»“æ„ï¼š

- Encoderï¼šé€æ­¥ä¸‹é‡‡æ ·ï¼Œæå–é«˜å±‚è¯­ä¹‰ç‰¹å¾
- Decoderï¼šé€æ­¥ä¸Šé‡‡æ ·ï¼Œæ¢å¤ç©ºé—´åˆ†è¾¨ç‡
- Skip Connectionï¼šèåˆæµ…å±‚ä¸æ·±å±‚ç‰¹å¾ï¼Œæå‡è¾¹ç•Œåˆ†å‰²æ•ˆæœ

U-Net æ˜¯åŒ»å­¦å›¾åƒåˆ†å‰²é¢†åŸŸçš„**åŸºç¡€æ¨¡å‹**ï¼Œéå¸¸é€‚åˆä½œä¸ºå…¥é—¨å­¦ä¹ ã€‚

---

## ğŸ“ é¡¹ç›®ç»“æ„è¯´æ˜

```text
.
â”œâ”€â”€ data/
â”‚   â”œâ”€â”€ train/
â”‚   â”‚   â”œâ”€â”€ images/
â”‚   â”‚   â””â”€â”€ _annotations.coco.json
â”‚   â”œâ”€â”€ val/
â”‚   â”‚   â”œâ”€â”€ images/
â”‚   â”‚   â””â”€â”€ _annotations.coco.json
â”‚   â””â”€â”€ test/
â”‚       â”œâ”€â”€ images/
â”‚       â””â”€â”€ _annotations.coco.json
â”‚
â”œâ”€â”€ utils/
â”‚   â””â”€â”€ dataset.py 
â”‚   â””â”€â”€ metrics.py 
â”‚   â””â”€â”€ visualization.py 
â”‚
â”œâ”€â”€ models/
â”‚   â””â”€â”€ unet.py          # U-Net ç½‘ç»œç»“æ„å®šä¹‰
â”‚
â”œâ”€â”€ train.py             # è®­ç»ƒè„šæœ¬
â”œâ”€â”€ test.py              # æ¨ç†è„šæœ¬
â”‚
â”œâ”€â”€ output/              # æ¨ç†ç»“æœä¿å­˜ç›®å½•
â”‚
â”œâ”€â”€ checkpoints/         # ä¿å­˜æ¨¡å‹
â”‚
â”œâ”€â”€ requirements.txt     # ä¾èµ–ç¯å¢ƒ
â””â”€â”€ README.md


ä½¿ç”¨æ–¹æ³•
1ï¸.ç¯å¢ƒé…ç½®

å»ºè®®ä½¿ç”¨ Python 3.8 åŠä»¥ä¸Šç‰ˆæœ¬ï¼Œå¹¶å®‰è£…å¿…è¦ä¾èµ–ï¼š

pip install -r requirements.txt


2ï¸.æ¨¡å‹è®­ç»ƒ

ç¡®ä¿æ•°æ®å·²æ­£ç¡®æ”¾ç½®åœ¨ data/train å’Œ data/val ç›®å½•ä¸‹ï¼Œç›´æ¥è¿è¡Œï¼š
python train.py
```

![img](./assets/001im.png)

![img](./assets/001ms.png)
